


ARM Macro Assembler    Page 1 


    1 00000000         ;;; Memory Address information found in the KL25P80M48SF
                       0RM document
    2 00000000 40048038 
                       SIM_SCGC5
                               EQU              0x40048038  ;The control for ea
                                                            ch ports Clock Gate
                                                             
    3 00000000 400FF000 
                       GPIOA_BASE
                               EQU              0x400FF000
    4 00000000 400FF040 
                       GPIOB_BASE
                               EQU              0x400FF040
    5 00000000 400FF080 
                       GPIOC_BASE
                               EQU              0x400FF080
    6 00000000 400FF0C0 
                       GPIOD_BASE
                               EQU              0x400FF0C0
    7 00000000 400FF100 
                       GPIOE_BASE
                               EQU              0x400FF100
    8 00000000         ;Base address offsets
    9 00000000 00000000 
                       GPIO_PDOR
                               EQU              0x00        ;Turn output pin on
                                                             or off
   10 00000000 00000004 
                       GPIO_PSOR
                               EQU              0x04        ;Turn output pin on
                                                            
   11 00000000 00000008 
                       GPIO_PCOR
                               EQU              0x08        ;Turn output pin of
                                                            f
   12 00000000 0000000C 
                       GPIO_PTOR
                               EQU              0x0C        ;Flip output pin
   13 00000000 00000010 
                       GPIO_PDIR
                               EQU              0x10        ;Turn input pin on 
                                                            or off
   14 00000000 00000014 
                       GPIO_PDDR
                               EQU              0x14        ;Set as input or ou
                                                            tput
   15 00000000         ;Pins in use
   16 00000000 40049004 
                       PORTA_PCR01
                               EQU              0x40049004  ;LED(red)
   17 00000000 40049008 
                       PORTA_PCR02
                               EQU              0x40049008  ;LED(yellow)
   18 00000000 40049010 
                       PORTA_PCR04
                               EQU              0x40049010  ;LED(green)
   19 00000000 4004B01C 
                       PORTC_PCR07
                               EQU              0x4004B01C  ;Button



ARM Macro Assembler    Page 2 


   20 00000000         
   21 00000000         ;;; Directives
   22 00000000                 PRESERVE8
   23 00000000                 THUMB
   24 00000000         
   25 00000000         ; Vector Table Mapped to Address 0 at Reset
   26 00000000         ; Linker requires __Vectors to be exported
   27 00000000         
   28 00000000                 AREA             RESET, DATA, READONLY
   29 00000000                 EXPORT           __Vectors
   30 00000000         __Vectors
   31 00000000 20001000        DCD              0x20001000  ; stack pointer val
                                                            ue when stack is em
                                                            pty
   32 00000004 00000000        DCD              Reset_Handler ; reset vector
   33 00000008                 ALIGN
   34 00000008         
   35 00000008         ; The program
   36 00000008         ; Linker requires Reset_Handler
   37 00000008         
   38 00000008                 AREA             MYCODE, CODE, READONLY
   39 00000000         
   40 00000000                 ENTRY
   41 00000000                 EXPORT           Reset_Handler
   42 00000000         Reset_Handler
   43 00000000         
   44 00000000         ;REMEMBER frometf --m32 option for .srec output!
   45 00000000         
   46 00000000         ;;;;;;;;;;PROGRAM CODE STARTS HERE;;;;;;;;;;;;  
   47 00000000         main    PROC
   48 00000000 F7FF FFFE       BL               initialize
   49 00000004 E7FE    deadloop
                               B                buttonpress
   50 00000006 E7FD            B                deadloop
   51 00000008 E7FE    stop    B                stop
   52 0000000A                 ENDP
   53 0000000A         
   54 0000000A         initialize
                               PROC
   55 0000000A         ;Initialize GPIO clock pins
   56 0000000A 4811            LDR              R0,=SIM_SCGC5 ;Load address of 
                                                            SIM_SCGC5 to R0  
   57 0000000C 6801            LDR              R1,[R0]     ;Put value of SIM_S
                                                            CGC5 into R1  
   58 0000000E 4A11            LDR              R2,=0x00003F80 ;Load value to t
                                                            urn on all port clo
                                                            cks into R2    
   59 00000010 4311            ORRS             R1,R2       ;OR R2 into R1 for 
                                                            use of masking  
   60 00000012 6001            STR              R1,[R0]     ;Put value back int
                                                            o SIM_SCGC5,   
   61 00000014         ;This puts 0011 1110 0000 0000, binary of 3E, into the S
                       im_SCGC5 register  
   62 00000014         ;Which turns on the port clocks A-E.
   63 00000014         ;;;Initialize GPIO pins
   64 00000014         ;LED (red)
   65 00000014 4810            LDR              R0,=PORTA_PCR01 ;Load address o
                                                            f PORTA_PCR01 to R0
                                                             



ARM Macro Assembler    Page 3 


   66 00000016 4911            LDR              R1,=0x100   ;Set port to GPIO 
   67 00000018 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
   68 0000001A         ;LED (yellow)
   69 0000001A 4811            LDR              R0,=PORTA_PCR02 ;Load address o
                                                            f PORTA_PCR02 to R0
                                                             
   70 0000001C 490F            LDR              R1,=0x100   ;Set port to GPIO 
   71 0000001E 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
   72 00000020         ;LED (green)
   73 00000020 4810            LDR              R0,=PORTA_PCR04 ;Load address o
                                                            f PORTA_PCR04 to R0
                                                             
   74 00000022 490E            LDR              R1,=0x100   ;Set port to GPIO 
   75 00000024 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
   76 00000026         ;LED PDDR
   77 00000026 4810            LDR              R0, =0x400FF014 ;Put value of P
                                                            ORTA_PDDR into R0
   78 00000028 4910            LDR              R1, =0x00000016 ;Set Pin(s) 1,2
                                                            ,4 to output (0001 
                                                            0110)
   79 0000002A 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
   80 0000002C         
   81 0000002C         ;Button
   82 0000002C 4810            LDR              R0,=PORTC_PCR07 ;Load address o
                                                            f PORTC_PCR07 to R0
                                                             
   83 0000002E 4911            LDR              R1,=0x103   ;Set port to GPIO a
                                                            nd enable pull up. 
                                                            
   84 00000030 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
   85 00000032         
   86 00000032 4811            LDR              R0, =0x400FF094 ;Put value of P
                                                            ORTC_PDDR into R0
   87 00000034 4911            LDR              R1, =0x00000000 ;Set Pins 0-31 
                                                            to input
   88 00000036 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
   89 00000038         
   90 00000038 4770            BX               LR
   91 0000003A                 ENDP
   92 0000003A         
   93 0000003A         buttonpress
                               PROC
   94 0000003A 4811            LDR              R0, =0x400FF090 ;Put address of
                                                             PORTC_PDIR into R0
                                                            
   95 0000003C 6801            LDR              R1, [R0]    ;Put value of PORTC
                                                            _PDIR into R1
   96 0000003E 4811            LDR              R0, =0x00000080 ;Put value of m
                                                            onitored input pin
   97 00000040 4201            TST              R1, R0      ;Check if input cha
                                                            nged
   98 00000042 490A            LDR              R1, =0x00000016 ;Turn pin(s) 1,
                                                            2,4, on



ARM Macro Assembler    Page 4 


   99 00000044 D0FE            BEQ              changelight ;Change LED if inpu
                                                            t has changed
  100 00000046 4770            BX               LR
  101 00000048                 ENDP
  102 00000048         
  103 00000048         changelight
                               PROC
  104 00000048 480F            LDR              R0, =0x400FF00C ;Put address of
                                                             PORTA_PDOR into R0
                                                            
  105 0000004A         ;LDR R1, =0x0000000F     ;Turn pin(s) 0-3, on
  106 0000004A 6001            STR              R1, [R0]    ;Put value into PDO
                                                            R
  107 0000004C 4770            BX               LR
  108 0000004E                 ENDP
  109 0000004E         
  110 0000004E                 END                          ;End of program
              00 00 40048038 
              00003F80 
              40049004 
              00000100 
              40049008 
              40049010 
              400FF014 
              00000016 
              4004B01C 
              00000103 
              400FF094 
              00000000 
              400FF090 
              00000080 
              400FF00C 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M0+ --apcs=inter
work --depend=.\objects\main.d -o.\objects\main.o -I"C:\Users\Nick\Documents\Gi
t Projects\TrafficLight\RTE" -IC:\Keil_v5\ARM\PACK\Keil\Kinetis_KLxx_DFP\1.7.0\
Device\Include -IC:\Keil_v5\ARM\CMSIS\Include --predefine="__EVAL SETA 1" --pre
define="__UVISION_VERSION SETA 516" --predefine="MKL25Z128xxx4 SETA 1" --list=.
\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

RESET 00000000

Symbol: RESET
   Definitions
      At line 28 in file main.s
   Uses
      None
Comment: RESET unused
__Vectors 00000000

Symbol: __Vectors
   Definitions
      At line 30 in file main.s
   Uses
      At line 29 in file main.s
Comment: __Vectors used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

MYCODE 00000000

Symbol: MYCODE
   Definitions
      At line 38 in file main.s
   Uses
      None
Comment: MYCODE unused
Reset_Handler 00000000

Symbol: Reset_Handler
   Definitions
      At line 42 in file main.s
   Uses
      At line 32 in file main.s
      At line 41 in file main.s

buttonpress 0000003A

Symbol: buttonpress
   Definitions
      At line 93 in file main.s
   Uses
      At line 49 in file main.s
Comment: buttonpress used once
changelight 00000048

Symbol: changelight
   Definitions
      At line 103 in file main.s
   Uses
      At line 99 in file main.s
Comment: changelight used once
deadloop 00000004

Symbol: deadloop
   Definitions
      At line 49 in file main.s
   Uses
      At line 50 in file main.s
Comment: deadloop used once
initialize 0000000A

Symbol: initialize
   Definitions
      At line 54 in file main.s
   Uses
      At line 48 in file main.s
Comment: initialize used once
main 00000000

Symbol: main
   Definitions
      At line 47 in file main.s
   Uses
      None
Comment: main unused
stop 00000008




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: stop
   Definitions
      At line 51 in file main.s
   Uses
      At line 51 in file main.s
Comment: stop used once
8 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

GPIOA_BASE 400FF000

Symbol: GPIOA_BASE
   Definitions
      At line 3 in file main.s
   Uses
      None
Comment: GPIOA_BASE unused
GPIOB_BASE 400FF040

Symbol: GPIOB_BASE
   Definitions
      At line 4 in file main.s
   Uses
      None
Comment: GPIOB_BASE unused
GPIOC_BASE 400FF080

Symbol: GPIOC_BASE
   Definitions
      At line 5 in file main.s
   Uses
      None
Comment: GPIOC_BASE unused
GPIOD_BASE 400FF0C0

Symbol: GPIOD_BASE
   Definitions
      At line 6 in file main.s
   Uses
      None
Comment: GPIOD_BASE unused
GPIOE_BASE 400FF100

Symbol: GPIOE_BASE
   Definitions
      At line 7 in file main.s
   Uses
      None
Comment: GPIOE_BASE unused
GPIO_PCOR 00000008

Symbol: GPIO_PCOR
   Definitions
      At line 11 in file main.s
   Uses
      None
Comment: GPIO_PCOR unused
GPIO_PDDR 00000014

Symbol: GPIO_PDDR
   Definitions
      At line 14 in file main.s
   Uses
      None
Comment: GPIO_PDDR unused
GPIO_PDIR 00000010

Symbol: GPIO_PDIR



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 13 in file main.s
   Uses
      None
Comment: GPIO_PDIR unused
GPIO_PDOR 00000000

Symbol: GPIO_PDOR
   Definitions
      At line 9 in file main.s
   Uses
      None
Comment: GPIO_PDOR unused
GPIO_PSOR 00000004

Symbol: GPIO_PSOR
   Definitions
      At line 10 in file main.s
   Uses
      None
Comment: GPIO_PSOR unused
GPIO_PTOR 0000000C

Symbol: GPIO_PTOR
   Definitions
      At line 12 in file main.s
   Uses
      None
Comment: GPIO_PTOR unused
PORTA_PCR01 40049004

Symbol: PORTA_PCR01
   Definitions
      At line 16 in file main.s
   Uses
      At line 65 in file main.s
Comment: PORTA_PCR01 used once
PORTA_PCR02 40049008

Symbol: PORTA_PCR02
   Definitions
      At line 17 in file main.s
   Uses
      At line 69 in file main.s
Comment: PORTA_PCR02 used once
PORTA_PCR04 40049010

Symbol: PORTA_PCR04
   Definitions
      At line 18 in file main.s
   Uses
      At line 73 in file main.s
Comment: PORTA_PCR04 used once
PORTC_PCR07 4004B01C

Symbol: PORTC_PCR07
   Definitions
      At line 19 in file main.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 82 in file main.s
Comment: PORTC_PCR07 used once
SIM_SCGC5 40048038

Symbol: SIM_SCGC5
   Definitions
      At line 2 in file main.s
   Uses
      At line 56 in file main.s
Comment: SIM_SCGC5 used once
16 symbols
361 symbols in table
