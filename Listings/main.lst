


ARM Macro Assembler    Page 1 


    1 00000000         ;;; Memory Address information found in the KL25P80M48SF
                       0RM document
    2 00000000 40048038 
                       SIM_SCGC5
                               EQU              0x40048038  ;The control for ea
                                                            ch ports Clock Gate
                                                             
    3 00000000 400FF000 
                       GPIOA_BASE
                               EQU              0x400FF000
    4 00000000 400FF040 
                       GPIOB_BASE
                               EQU              0x400FF040
    5 00000000 400FF080 
                       GPIOC_BASE
                               EQU              0x400FF080
    6 00000000 400FF0C0 
                       GPIOD_BASE
                               EQU              0x400FF0C0
    7 00000000 400FF100 
                       GPIOE_BASE
                               EQU              0x400FF100
    8 00000000         ;Base address offsets
    9 00000000 00000000 
                       GPIO_PDOR
                               EQU              0x00        ;Turn output pin on
                                                             or off
   10 00000000 00000004 
                       GPIO_PSOR
                               EQU              0x04        ;Turn output pin on
                                                            
   11 00000000 00000008 
                       GPIO_PCOR
                               EQU              0x08        ;Turn output pin of
                                                            f
   12 00000000 0000000C 
                       GPIO_PTOR
                               EQU              0x0C        ;Flip output pin
   13 00000000 00000010 
                       GPIO_PDIR
                               EQU              0x10        ;Turn input pin on 
                                                            or off
   14 00000000 00000014 
                       GPIO_PDDR
                               EQU              0x14        ;Set as input or ou
                                                            tput
   15 00000000         ;Pins in use
   16 00000000 40049004 
                       PORTA_PCR01
                               EQU              0x40049004  ;LED(red)
   17 00000000 40049008 
                       PORTA_PCR02
                               EQU              0x40049008  ;LED(yellow)
   18 00000000 40049010 
                       PORTA_PCR04
                               EQU              0x40049010  ;LED(green)
   19 00000000 4004B01C 
                       PORTC_PCR07
                               EQU              0x4004B01C  ;Button



ARM Macro Assembler    Page 2 


   20 00000000         
   21 00000000         ;;; Directives
   22 00000000                 PRESERVE8
   23 00000000                 THUMB
   24 00000000         
   25 00000000         ; Vector Table Mapped to Address 0 at Reset
   26 00000000         ; Linker requires __Vectors to be exported
   27 00000000         
   28 00000000                 AREA             RESET, DATA, READONLY
   29 00000000                 EXPORT           __Vectors
   30 00000000         __Vectors
   31 00000000 20001000        DCD              0x20001000  ; stack pointer val
                                                            ue when stack is em
                                                            pty
   32 00000004 00000000        DCD              Reset_Handler ; reset vector
   33 00000008                 ALIGN
   34 00000008         
   35 00000008         ; The program
   36 00000008         ; Linker requires Reset_Handler
   37 00000008         
   38 00000008                 AREA             MYCODE, CODE, READONLY
   39 00000000         
   40 00000000                 ENTRY
   41 00000000                 EXPORT           Reset_Handler
   42 00000000         Reset_Handler
   43 00000000         
   44 00000000         ;REMEMBER frometf --m32 option for .srec output!
   45 00000000         
   46 00000000         ;;;;;;;;;;PROGRAM CODE STARTS HERE;;;;;;;;;;;;  
   47 00000000         main
   48 00000000 4825            LDR              R0, =0x00000000
   49 00000002 4925            LDR              R1, =0x00000000
   50 00000004 4A24            LDR              R2, =0x00000000
   51 00000006 4B24            LDR              R3, =0x00000000
   52 00000008 4C23            LDR              R4, =0x00000000
   53 0000000A 4D23            LDR              R5, =0x00000000
   54 0000000C 4E22            LDR              R6, =0x00000000
   55 0000000E 4F22            LDR              R7, =0x00000000
   56 00000010         
   57 00000010 F000 F82A       BL               initialize  ;Initialize I/O por
                                                            ts
   58 00000014         
   59 00000014 4921    reset   LDR              R1, =0x00000002 ;Change light t
                                                            o red
   60 00000016 F000 F824       BL               changelight ;
   61 0000001A         
   62 0000001A 4B21            LDR              R3, =0x00000011 ;Put value into
                                                             counter (1 loop ju
                                                            st to show code wor
                                                            ks)
   63 0000001C F000 F81A 
                       d30_1   BL               buttonpress ;Check for button p
                                                            ress
   64 00000020 3B11            SUBS             R3, #17     ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   65 00000022 2B00            CMP              R3, #0
   66 00000024 DCFA            BGT              d30_1
   67 00000026         



ARM Macro Assembler    Page 3 


   68 00000026 2E01            CMP              R6, #1      ;Check for button p
                                                            ress
   69 00000028 D0F4            BEQ              reset       ;Reset to red if pr
                                                            essed
   70 0000002A 491E            LDR              R1, =0x00000010 ;Change light t
                                                            o green
   71 0000002C F000 F819       BL               changelight ;
   72 00000030         
   73 00000030 4B1D            LDR              R3, =0x00D76AB5 ;Put value into
                                                             counter (5 seconds
                                                            , the board resets 
                                                            when counter is thi
                                                            s high)
   74 00000032 F000 F80F 
                       d30_2   BL               buttonpress ;Check for button p
                                                            ress
   75 00000036 3B01            SUBS             R3, #1      ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   76 00000038 2B00            CMP              R3, #0
   77 0000003A DCFA            BGT              d30_2
   78 0000003C         
   79 0000003C 2E01            CMP              R6, #1      ;Check for button p
                                                            ress
   80 0000003E D0E9            BEQ              reset       ;Reset to red if pr
                                                            essed
   81 00000040 491A            LDR              R1, =0x00000005 ;Change light t
                                                            o yellow
   82 00000042 F000 F80E       BL               changelight ;
   83 00000046         
   84 00000046 4B18            LDR              R3, =0x00D76AB5 ;Put value into
                                                             counter (? seconds
                                                            )
   85 00000048 F000 F804 
                       d10_1   BL               buttonpress ;Check for button p
                                                            ress
   86 0000004C 3B01            SUBS             R3, #1      ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   87 0000004E 2B00            CMP              R3, #0
   88 00000050 DCFA            BGT              d10_1
   89 00000052 E7DF            B                reset       ;Reset to beginning
                                                            
   90 00000054         
   91 00000054         ;;;Subroutines
   92 00000054         buttonpress
   93 00000054 4816            LDR              R0, =0x400FF090 ;Put address of
                                                             PORTC_PDIR into R0
                                                            
   94 00000056 6801            LDR              R1, [R0]    ;Put value of PORTC
                                                            _PDIR into R1
   95 00000058 4816            LDR              R0, =0x00000080 ;Put value of m
                                                            onitored input pin
   96 0000005A 4201            TST              R1, R0      ;Check for button p
                                                            ress
   97 0000005C D100            BNE              nopress     ;Break from process
                                                             if button not pres
                                                            sed
   98 0000005E 2601            MOVS             R6, #1      ;Put 1 in R6 if but



ARM Macro Assembler    Page 4 


                                                            ton has been presse
                                                            d
   99 00000060 4770    nopress BX               LR
  100 00000062         
  101 00000062         changelight
  102 00000062 4815            LDR              R0, =0x400FF000 ;Put address of
                                                             PORTA_PDOR into R0
                                                            
  103 00000064 6001            STR              R1, [R0]    ;Put value into PDO
                                                            R
  104 00000066 4770            BX               LR
  105 00000068         
  106 00000068         initialize
  107 00000068         ;Initialize GPIO clock
  108 00000068 4814            LDR              R0,=SIM_SCGC5 ;Load address of 
                                                            SIM_SCGC5 to R0  
  109 0000006A 6801            LDR              R1,[R0]     ;Put value of SIM_S
                                                            CGC5 into R1  
  110 0000006C 4A14            LDR              R2,=0x00003F80 ;Load value to t
                                                            urn on all port clo
                                                            cks into R2    
  111 0000006E 4311            ORRS             R1,R2       ;OR R2 into R1 for 
                                                            use of masking  
  112 00000070 6001            STR              R1,[R0]     ;Put value back int
                                                            o SIM_SCGC5,   
  113 00000072         ;This puts 0011 1110 0000 0000, binary of 3E, into the S
                       im_SCGC5 register  
  114 00000072         ;Which turns on the port clocks A-E.
  115 00000072         ;;Initialize GPIO pins
  116 00000072         ;LED (red)
  117 00000072 4814            LDR              R0,=PORTA_PCR01 ;Load address o
                                                            f PORTA_PCR01 to R0
                                                             
  118 00000074 4914            LDR              R1,=0x100   ;Set port to GPIO 
  119 00000076 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  120 00000078         ;LED (yellow)
  121 00000078 4814            LDR              R0,=PORTA_PCR02 ;Load address o
                                                            f PORTA_PCR02 to R0
                                                             
  122 0000007A 4913            LDR              R1,=0x100   ;Set port to GPIO 
  123 0000007C 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  124 0000007E         ;LED (green)
  125 0000007E 4814            LDR              R0,=PORTA_PCR04 ;Load address o
                                                            f PORTA_PCR04 to R0
                                                             
  126 00000080 4911            LDR              R1,=0x100   ;Set port to GPIO 
  127 00000082 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  128 00000084         ;LED PDDR
  129 00000084 4813            LDR              R0, =0x400FF014 ;Put value of P
                                                            ORTA_PDDR into R0
  130 00000086 4914            LDR              R1, =0x00000016 ;Set Pin(s) 1,2
                                                            ,4 to output (0001 
                                                            0110)
  131 00000088 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
  132 0000008A         



ARM Macro Assembler    Page 5 


  133 0000008A         ;Button
  134 0000008A 4814            LDR              R0,=PORTC_PCR07 ;Load address o
                                                            f PORTC_PCR07 to R0
                                                             
  135 0000008C 4914            LDR              R1,=0x103   ;Set port to GPIO a
                                                            nd enable pull up. 
                                                            
  136 0000008E 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  137 00000090         
  138 00000090 4814            LDR              R0, =0x400FF094 ;Put value of P
                                                            ORTC_PDDR into R0
  139 00000092 4901            LDR              R1, =0x00000000 ;Set Pins 0-31 
                                                            to input
  140 00000094 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
  141 00000096         
  142 00000096 4770            BX               LR
  143 00000098         
  144 00000098         
  145 00000098                 END                          ;End of program
              00000000 
              00000002 
              00000011 
              00000010 
              00D76AB5 
              00000005 
              400FF090 
              00000080 
              400FF000 
              40048038 
              00003F80 
              40049004 
              00000100 
              40049008 
              40049010 
              400FF014 
              00000016 
              4004B01C 
              00000103 
              400FF094 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M0+ --apcs=inter
work --depend=.\objects\main.d -o.\objects\main.o -I"C:\Users\Nick\Documents\Gi
t Projects\TrafficLight\RTE" -IC:\Keil_v5\ARM\PACK\Keil\Kinetis_KLxx_DFP\1.7.0\
Device\Include -IC:\Keil_v5\ARM\CMSIS\Include --predefine="__EVAL SETA 1" --pre
define="__UVISION_VERSION SETA 516" --predefine="MKL25Z128xxx4 SETA 1" --list=.
\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

RESET 00000000

Symbol: RESET
   Definitions
      At line 28 in file main.s
   Uses
      None
Comment: RESET unused
__Vectors 00000000

Symbol: __Vectors
   Definitions
      At line 30 in file main.s
   Uses
      At line 29 in file main.s
Comment: __Vectors used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

MYCODE 00000000

Symbol: MYCODE
   Definitions
      At line 38 in file main.s
   Uses
      None
Comment: MYCODE unused
Reset_Handler 00000000

Symbol: Reset_Handler
   Definitions
      At line 42 in file main.s
   Uses
      At line 32 in file main.s
      At line 41 in file main.s

buttonpress 00000054

Symbol: buttonpress
   Definitions
      At line 92 in file main.s
   Uses
      At line 63 in file main.s
      At line 74 in file main.s
      At line 85 in file main.s

changelight 00000062

Symbol: changelight
   Definitions
      At line 101 in file main.s
   Uses
      At line 60 in file main.s
      At line 71 in file main.s
      At line 82 in file main.s

d10_1 00000048

Symbol: d10_1
   Definitions
      At line 85 in file main.s
   Uses
      At line 88 in file main.s
Comment: d10_1 used once
d30_1 0000001C

Symbol: d30_1
   Definitions
      At line 63 in file main.s
   Uses
      At line 66 in file main.s
Comment: d30_1 used once
d30_2 00000032

Symbol: d30_2
   Definitions
      At line 74 in file main.s
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 77 in file main.s
Comment: d30_2 used once
initialize 00000068

Symbol: initialize
   Definitions
      At line 106 in file main.s
   Uses
      At line 57 in file main.s
Comment: initialize used once
main 00000000

Symbol: main
   Definitions
      At line 47 in file main.s
   Uses
      None
Comment: main unused
nopress 00000060

Symbol: nopress
   Definitions
      At line 99 in file main.s
   Uses
      At line 97 in file main.s
Comment: nopress used once
reset 00000014

Symbol: reset
   Definitions
      At line 59 in file main.s
   Uses
      At line 69 in file main.s
      At line 80 in file main.s
      At line 89 in file main.s

11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

GPIOA_BASE 400FF000

Symbol: GPIOA_BASE
   Definitions
      At line 3 in file main.s
   Uses
      None
Comment: GPIOA_BASE unused
GPIOB_BASE 400FF040

Symbol: GPIOB_BASE
   Definitions
      At line 4 in file main.s
   Uses
      None
Comment: GPIOB_BASE unused
GPIOC_BASE 400FF080

Symbol: GPIOC_BASE
   Definitions
      At line 5 in file main.s
   Uses
      None
Comment: GPIOC_BASE unused
GPIOD_BASE 400FF0C0

Symbol: GPIOD_BASE
   Definitions
      At line 6 in file main.s
   Uses
      None
Comment: GPIOD_BASE unused
GPIOE_BASE 400FF100

Symbol: GPIOE_BASE
   Definitions
      At line 7 in file main.s
   Uses
      None
Comment: GPIOE_BASE unused
GPIO_PCOR 00000008

Symbol: GPIO_PCOR
   Definitions
      At line 11 in file main.s
   Uses
      None
Comment: GPIO_PCOR unused
GPIO_PDDR 00000014

Symbol: GPIO_PDDR
   Definitions
      At line 14 in file main.s
   Uses
      None
Comment: GPIO_PDDR unused
GPIO_PDIR 00000010

Symbol: GPIO_PDIR



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 13 in file main.s
   Uses
      None
Comment: GPIO_PDIR unused
GPIO_PDOR 00000000

Symbol: GPIO_PDOR
   Definitions
      At line 9 in file main.s
   Uses
      None
Comment: GPIO_PDOR unused
GPIO_PSOR 00000004

Symbol: GPIO_PSOR
   Definitions
      At line 10 in file main.s
   Uses
      None
Comment: GPIO_PSOR unused
GPIO_PTOR 0000000C

Symbol: GPIO_PTOR
   Definitions
      At line 12 in file main.s
   Uses
      None
Comment: GPIO_PTOR unused
PORTA_PCR01 40049004

Symbol: PORTA_PCR01
   Definitions
      At line 16 in file main.s
   Uses
      At line 117 in file main.s
Comment: PORTA_PCR01 used once
PORTA_PCR02 40049008

Symbol: PORTA_PCR02
   Definitions
      At line 17 in file main.s
   Uses
      At line 121 in file main.s
Comment: PORTA_PCR02 used once
PORTA_PCR04 40049010

Symbol: PORTA_PCR04
   Definitions
      At line 18 in file main.s
   Uses
      At line 125 in file main.s
Comment: PORTA_PCR04 used once
PORTC_PCR07 4004B01C

Symbol: PORTC_PCR07
   Definitions
      At line 19 in file main.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 134 in file main.s
Comment: PORTC_PCR07 used once
SIM_SCGC5 40048038

Symbol: SIM_SCGC5
   Definitions
      At line 2 in file main.s
   Uses
      At line 108 in file main.s
Comment: SIM_SCGC5 used once
16 symbols
364 symbols in table
