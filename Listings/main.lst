


ARM Macro Assembler    Page 1 


    1 00000000         ;;; Memory Address information found in the KL25P80M48SF
                       0RM document
    2 00000000 40048038 
                       SIM_SCGC5
                               EQU              0x40048038  ;The control for ea
                                                            ch ports Clock Gate
                                                             
    3 00000000 400FF000 
                       GPIOA_BASE
                               EQU              0x400FF000
    4 00000000 400FF040 
                       GPIOB_BASE
                               EQU              0x400FF040
    5 00000000 400FF080 
                       GPIOC_BASE
                               EQU              0x400FF080
    6 00000000 400FF0C0 
                       GPIOD_BASE
                               EQU              0x400FF0C0
    7 00000000 400FF100 
                       GPIOE_BASE
                               EQU              0x400FF100
    8 00000000         ;Base address offsets
    9 00000000 00000000 
                       GPIO_PDOR
                               EQU              0x00        ;Turn output pin on
                                                             or off
   10 00000000 00000004 
                       GPIO_PSOR
                               EQU              0x04        ;Turn output pin on
                                                            
   11 00000000 00000008 
                       GPIO_PCOR
                               EQU              0x08        ;Turn output pin of
                                                            f
   12 00000000 0000000C 
                       GPIO_PTOR
                               EQU              0x0C        ;Flip output pin
   13 00000000 00000010 
                       GPIO_PDIR
                               EQU              0x10        ;Turn input pin on 
                                                            or off
   14 00000000 00000014 
                       GPIO_PDDR
                               EQU              0x14        ;Set as input or ou
                                                            tput
   15 00000000         ;Pins in use
   16 00000000 40049004 
                       PORTA_PCR01
                               EQU              0x40049004  ;LED(red)
   17 00000000 40049008 
                       PORTA_PCR02
                               EQU              0x40049008  ;LED(yellow)
   18 00000000 40049010 
                       PORTA_PCR04
                               EQU              0x40049010  ;LED(green)
   19 00000000 4004B01C 
                       PORTC_PCR07
                               EQU              0x4004B01C  ;Button



ARM Macro Assembler    Page 2 


   20 00000000         
   21 00000000         ;;; Directives
   22 00000000                 PRESERVE8
   23 00000000                 THUMB
   24 00000000         
   25 00000000         ; Vector Table Mapped to Address 0 at Reset
   26 00000000         ; Linker requires __Vectors to be exported
   27 00000000         
   28 00000000                 AREA             RESET, DATA, READONLY
   29 00000000                 EXPORT           __Vectors
   30 00000000         __Vectors
   31 00000000 20001000        DCD              0x20001000  ; stack pointer val
                                                            ue when stack is em
                                                            pty
   32 00000004 00000000        DCD              Reset_Handler ; reset vector
   33 00000008                 ALIGN
   34 00000008         
   35 00000008         ; The program
   36 00000008         ; Linker requires Reset_Handler
   37 00000008         
   38 00000008                 AREA             MYCODE, CODE, READONLY
   39 00000000         
   40 00000000                 ENTRY
   41 00000000                 EXPORT           Reset_Handler
   42 00000000         Reset_Handler
   43 00000000         
   44 00000000         ;REMEMBER frometf --m32 option for .srec output!
   45 00000000         
   46 00000000         ;;;;;;;;;;PROGRAM CODE STARTS HERE;;;;;;;;;;;;  
   47 00000000         main
   48 00000000 4824            LDR              R0, =0X00000000
   49 00000002 4924            LDR              R1, =0X00000000
   50 00000004 4A23            LDR              R2, =0X00000000
   51 00000006 4B23            LDR              R3, =0X00000000
   52 00000008 4E22            LDR              R6, =0X00000000
   53 0000000A         
   54 0000000A         
   55 0000000A         
   56 0000000A F000 F82A       BL               initialize  ;Initialize I/O por
                                                            ts
   57 0000000E         
   58 0000000E 4922    reset   LDR              R1, =0x00000002 ;Change light t
                                                            o red
   59 00000010 F000 F824       BL               changelight ;
   60 00000014         
   61 00000014 4B21            LDR              R3, =0x0E4E1600 ;Put value into
                                                             counter (? seconds
                                                            )
   62 00000016 F000 F81A 
                       d30_1   BL               buttonpress ;Check for button p
                                                            ress
   63 0000001A 3B11            SUBS             R3, #17     ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   64 0000001C 2B00            CMP              R3, #0
   65 0000001E DCFA            BGT              d30_1
   66 00000020         
   67 00000020 2E01            CMP              R6, #1      ;Check for button p
                                                            ress



ARM Macro Assembler    Page 3 


   68 00000022 D0F4            BEQ              reset       ;Reset to red if pr
                                                            essed
   69 00000024 491E            LDR              R1, =0x00000010 ;Change light t
                                                            o green
   70 00000026 F000 F819       BL               changelight ;
   71 0000002A         
   72 0000002A 4B1C            LDR              R3, =0x0E4E1600 ;Put value into
                                                             counter (? seconds
                                                            )
   73 0000002C F000 F80F 
                       d30_2   BL               buttonpress ;Check for button p
                                                            ress
   74 00000030 3B11            SUBS             R3, #17     ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   75 00000032 2B00            CMP              R3, #0
   76 00000034 DCFA            BGT              d30_2
   77 00000036         
   78 00000036 2E01            CMP              R6, #1      ;Check for button p
                                                            ress
   79 00000038 D0E9            BEQ              reset       ;Reset to red if pr
                                                            essed
   80 0000003A 491A            LDR              R1, =0x00000011 ;Change light t
                                                            o yellow
   81 0000003C F000 F80E       BL               changelight ;
   82 00000040         
   83 00000040 4B16            LDR              R3, =0x0E4E1600 ;Put value into
                                                             counter (? seconds
                                                            )
   84 00000042 F000 F804 
                       d10_1   BL               buttonpress ;Check for button p
                                                            ress
   85 00000046 3B11            SUBS             R3, #17     ;Subtract # of tick
                                                            s in loop (17) from
                                                             counter
   86 00000048 2B00            CMP              R3, #0
   87 0000004A DCFA            BGT              d10_1
   88 0000004C E7DF            B                reset       ;Reset to beginning
                                                            
   89 0000004E         
   90 0000004E         ;;;Subroutines
   91 0000004E         buttonpress
   92 0000004E 4816            LDR              R0, =0x400FF090 ;Put address of
                                                             PORTC_PDIR into R0
                                                            
   93 00000050 6801            LDR              R1, [R0]    ;Put value of PORTC
                                                            _PDIR into R1
   94 00000052 4816            LDR              R0, =0x00000080 ;Put value of m
                                                            onitored input pin
   95 00000054 4201            TST              R1, R0      ;Check for button p
                                                            ress
   96 00000056 D000            BEQ              nopress     ;Break from process
                                                             if button not pres
                                                            sed
   97 00000058 2601            MOVS             R6, #1      ;Put 1 in R6 if but
                                                            ton has been presse
                                                            d
   98 0000005A 4770    nopress BX               LR
   99 0000005C         



ARM Macro Assembler    Page 4 


  100 0000005C         changelight
  101 0000005C 4814            LDR              R0, =0x400FF000 ;Put address of
                                                             PORTA_PDOR into R0
                                                            
  102 0000005E 6001            STR              R1, [R0]    ;Put value into PDO
                                                            R
  103 00000060 4770            BX               LR
  104 00000062         
  105 00000062         initialize
  106 00000062         ;Initialize GPIO clock
  107 00000062 4814            LDR              R0,=SIM_SCGC5 ;Load address of 
                                                            SIM_SCGC5 to R0  
  108 00000064 6801            LDR              R1,[R0]     ;Put value of SIM_S
                                                            CGC5 into R1  
  109 00000066 4A14            LDR              R2,=0x00003F80 ;Load value to t
                                                            urn on all port clo
                                                            cks into R2    
  110 00000068 4311            ORRS             R1,R2       ;OR R2 into R1 for 
                                                            use of masking  
  111 0000006A 6001            STR              R1,[R0]     ;Put value back int
                                                            o SIM_SCGC5,   
  112 0000006C         ;This puts 0011 1110 0000 0000, binary of 3E, into the S
                       im_SCGC5 register  
  113 0000006C         ;Which turns on the port clocks A-E.
  114 0000006C         ;;Initialize GPIO pins
  115 0000006C         ;LED (red)
  116 0000006C 4813            LDR              R0,=PORTA_PCR01 ;Load address o
                                                            f PORTA_PCR01 to R0
                                                             
  117 0000006E 4914            LDR              R1,=0x100   ;Set port to GPIO 
  118 00000070 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  119 00000072         ;LED (yellow)
  120 00000072 4814            LDR              R0,=PORTA_PCR02 ;Load address o
                                                            f PORTA_PCR02 to R0
                                                             
  121 00000074 4912            LDR              R1,=0x100   ;Set port to GPIO 
  122 00000076 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  123 00000078         ;LED (green)
  124 00000078 4813            LDR              R0,=PORTA_PCR04 ;Load address o
                                                            f PORTA_PCR04 to R0
                                                             
  125 0000007A 4911            LDR              R1,=0x100   ;Set port to GPIO 
  126 0000007C 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  127 0000007E         ;LED PDDR
  128 0000007E 4813            LDR              R0, =0x400FF014 ;Put value of P
                                                            ORTA_PDDR into R0
  129 00000080 4913            LDR              R1, =0x00000016 ;Set Pin(s) 1,2
                                                            ,4 to output (0001 
                                                            0110)
  130 00000082 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
  131 00000084         
  132 00000084         ;Button
  133 00000084 4813            LDR              R0,=PORTC_PCR07 ;Load address o
                                                            f PORTC_PCR07 to R0
                                                             



ARM Macro Assembler    Page 5 


  134 00000086 4914            LDR              R1,=0x103   ;Set port to GPIO a
                                                            nd enable pull up. 
                                                            
  135 00000088 6001            STR              R1,[R0]     ;Put value back int
                                                            o PCR
  136 0000008A         
  137 0000008A 4814            LDR              R0, =0x400FF094 ;Put value of P
                                                            ORTC_PDDR into R0
  138 0000008C 4901            LDR              R1, =0x00000000 ;Set Pins 0-31 
                                                            to input
  139 0000008E 6001            STR              R1,[R0]     ;Put value back int
                                                            o PDDR
  140 00000090         
  141 00000090 4770            BX               LR
  142 00000092         
  143 00000092         
  144 00000092                 END                          ;End of program
              00 00 00000000 
              00000002 
              0E4E1600 
              00000010 
              00000011 
              400FF090 
              00000080 
              400FF000 
              40048038 
              00003F80 
              40049004 
              00000100 
              40049008 
              40049010 
              400FF014 
              00000016 
              4004B01C 
              00000103 
              400FF094 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M0+ --apcs=inter
work --depend=.\objects\main.d -o.\objects\main.o -I"C:\Users\Nick\Documents\Gi
t Projects\TrafficLight\RTE" -IC:\Keil_v5\ARM\PACK\Keil\Kinetis_KLxx_DFP\1.7.0\
Device\Include -IC:\Keil_v5\ARM\CMSIS\Include --predefine="__EVAL SETA 1" --pre
define="__UVISION_VERSION SETA 516" --predefine="MKL25Z128xxx4 SETA 1" --list=.
\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

RESET 00000000

Symbol: RESET
   Definitions
      At line 28 in file main.s
   Uses
      None
Comment: RESET unused
__Vectors 00000000

Symbol: __Vectors
   Definitions
      At line 30 in file main.s
   Uses
      At line 29 in file main.s
Comment: __Vectors used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

MYCODE 00000000

Symbol: MYCODE
   Definitions
      At line 38 in file main.s
   Uses
      None
Comment: MYCODE unused
Reset_Handler 00000000

Symbol: Reset_Handler
   Definitions
      At line 42 in file main.s
   Uses
      At line 32 in file main.s
      At line 41 in file main.s

buttonpress 0000004E

Symbol: buttonpress
   Definitions
      At line 91 in file main.s
   Uses
      At line 62 in file main.s
      At line 73 in file main.s
      At line 84 in file main.s

changelight 0000005C

Symbol: changelight
   Definitions
      At line 100 in file main.s
   Uses
      At line 59 in file main.s
      At line 70 in file main.s
      At line 81 in file main.s

d10_1 00000042

Symbol: d10_1
   Definitions
      At line 84 in file main.s
   Uses
      At line 87 in file main.s
Comment: d10_1 used once
d30_1 00000016

Symbol: d30_1
   Definitions
      At line 62 in file main.s
   Uses
      At line 65 in file main.s
Comment: d30_1 used once
d30_2 0000002C

Symbol: d30_2
   Definitions
      At line 73 in file main.s
   Uses



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 76 in file main.s
Comment: d30_2 used once
initialize 00000062

Symbol: initialize
   Definitions
      At line 105 in file main.s
   Uses
      At line 56 in file main.s
Comment: initialize used once
main 00000000

Symbol: main
   Definitions
      At line 47 in file main.s
   Uses
      None
Comment: main unused
nopress 0000005A

Symbol: nopress
   Definitions
      At line 98 in file main.s
   Uses
      At line 96 in file main.s
Comment: nopress used once
reset 0000000E

Symbol: reset
   Definitions
      At line 58 in file main.s
   Uses
      At line 68 in file main.s
      At line 79 in file main.s
      At line 88 in file main.s

11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

GPIOA_BASE 400FF000

Symbol: GPIOA_BASE
   Definitions
      At line 3 in file main.s
   Uses
      None
Comment: GPIOA_BASE unused
GPIOB_BASE 400FF040

Symbol: GPIOB_BASE
   Definitions
      At line 4 in file main.s
   Uses
      None
Comment: GPIOB_BASE unused
GPIOC_BASE 400FF080

Symbol: GPIOC_BASE
   Definitions
      At line 5 in file main.s
   Uses
      None
Comment: GPIOC_BASE unused
GPIOD_BASE 400FF0C0

Symbol: GPIOD_BASE
   Definitions
      At line 6 in file main.s
   Uses
      None
Comment: GPIOD_BASE unused
GPIOE_BASE 400FF100

Symbol: GPIOE_BASE
   Definitions
      At line 7 in file main.s
   Uses
      None
Comment: GPIOE_BASE unused
GPIO_PCOR 00000008

Symbol: GPIO_PCOR
   Definitions
      At line 11 in file main.s
   Uses
      None
Comment: GPIO_PCOR unused
GPIO_PDDR 00000014

Symbol: GPIO_PDDR
   Definitions
      At line 14 in file main.s
   Uses
      None
Comment: GPIO_PDDR unused
GPIO_PDIR 00000010

Symbol: GPIO_PDIR



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 13 in file main.s
   Uses
      None
Comment: GPIO_PDIR unused
GPIO_PDOR 00000000

Symbol: GPIO_PDOR
   Definitions
      At line 9 in file main.s
   Uses
      None
Comment: GPIO_PDOR unused
GPIO_PSOR 00000004

Symbol: GPIO_PSOR
   Definitions
      At line 10 in file main.s
   Uses
      None
Comment: GPIO_PSOR unused
GPIO_PTOR 0000000C

Symbol: GPIO_PTOR
   Definitions
      At line 12 in file main.s
   Uses
      None
Comment: GPIO_PTOR unused
PORTA_PCR01 40049004

Symbol: PORTA_PCR01
   Definitions
      At line 16 in file main.s
   Uses
      At line 116 in file main.s
Comment: PORTA_PCR01 used once
PORTA_PCR02 40049008

Symbol: PORTA_PCR02
   Definitions
      At line 17 in file main.s
   Uses
      At line 120 in file main.s
Comment: PORTA_PCR02 used once
PORTA_PCR04 40049010

Symbol: PORTA_PCR04
   Definitions
      At line 18 in file main.s
   Uses
      At line 124 in file main.s
Comment: PORTA_PCR04 used once
PORTC_PCR07 4004B01C

Symbol: PORTC_PCR07
   Definitions
      At line 19 in file main.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 133 in file main.s
Comment: PORTC_PCR07 used once
SIM_SCGC5 40048038

Symbol: SIM_SCGC5
   Definitions
      At line 2 in file main.s
   Uses
      At line 107 in file main.s
Comment: SIM_SCGC5 used once
16 symbols
364 symbols in table
